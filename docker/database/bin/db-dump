. $(dirname "$0")/_vars

customlog "creation of $structure_dump_name"
# Structure only
mariadb-dump -u$usr -p$pass -h $dbhost --no-data  $dbname > $dumppath/$structure_dump_name
customlog "end of creation of $structure_dump_name"

customlog "creation of $data_dump_name"
# separate each insert
echo "SET FOREIGN_KEY_CHECKS=0;" > $dumppath/$data_dump_name
mariadb-dump -u$usr -p$pass -h $dbhost $dbname --skip-triggers --compact --no-create-info --extended-insert=FALSE  >> $dumppath/$data_dump_name
echo "SET FOREIGN_KEY_CHECKS=1;" >> $dumppath/$data_dump_name
customlog "end of creation of $data_dump_name"


customlog "creation of $tar_file"
tar czf  $dumppath/$tar_file -C $dumppath `ls $dumppath | grep '\.sql$'`
customlog "end of creation of $tar_file"